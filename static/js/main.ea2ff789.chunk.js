(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{25:function(e,n,t){},26:function(e,n,t){},35:function(e,n){},36:function(e,n,t){},37:function(e,n,t){"use strict";t.r(n);var r=t(0),a=t(1),c=t.n(a),s=t(15),o=t.n(s),u=(t(25),t(2)),i=(t(26),t(16)),l={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:stun2.l.google.com:19302"]}]};function d(e){console.log("opened chat!!"),console.log(e.messageHandlers);var n={type:"info",value:"successfully opened connection!!"};for(var t in e.messageHandlers)e.messageHandlers[t](n)}function f(e,n){console.log("received message!"),console.log(e.messageHandlers);var t=JSON.parse(n.data);for(var r in console.log(t),e.messageHandlers)e.messageHandlers[r](t)}function h(e,n){var t=e.messageHandlersIndx;return e.messageHandlers[t]=n,e.messageHandlersIndx="".concat(parseInt(t)+1),t}function p(e,n){e&&(console.log("removing key ".concat(n," from conn ").concat(e)),delete e.messageHandlers[n])}function j(e,n){e.dc.send(JSON.stringify(n))}function g(e){return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function b(e){var n=e;return n.length%4!==0&&(n+="===".slice(0,4-n.length%4)),n=n.replace(/-/g,"+").replace(/_/g,"/"),atob(n)}var O=t(3),m=t.n(O),v=t(8),y=t(6),R=t(5),x=t(9),A=t(17),S=t.n(A);function T(e,n){e||(console.error("assertion failed"),console.error(JSON.parse(JSON.stringify(n))))}function C(e,n){for(var t,r,a=e.length;0!==a;)r=Math.floor(n()*a),t=e[a-=1],e[a]=e[r],e[r]=t;return e}function E(){T(!1,"not implemented yet!!")}function P(e){return k.apply(this,arguments)}function k(){return(k=Object(v.a)(m.a.mark((function e(n){var t,r,a,c,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new TextEncoder,r=t.encode(n),e.next=4,crypto.subtle.digest("SHA-256",r);case 4:return a=e.sent,c=Array.from(new Uint8Array(a)),s=c.map((function(e){return e.toString(16).padStart(2,"0")})).join(""),e.abrupt("return",s);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var w="Q",Y="K",_=["A","2","3","4","5","6","7","8","9","10","J",w,Y],N=["spades","hearts","diamonds","clubs"],L="VOID_CARD";function I(e,n){return C(function(e){e||(e=0);var n,t=[],r=0,a=0,c=Object(R.a)(N);try{for(c.s();!(n=c.n()).done;){var s,o=n.value,u=0,i=Object(R.a)(_);try{for(i.s();!(s=i.n()).done;){var l=s.value;u>=e&&t.push({rank:l,suit:o,rank_index:u,suit_index:r,index:a}),u++,a++}}catch(d){i.e(d)}finally{i.f()}r++}}catch(d){c.e(d)}finally{c.f()}return t}(n),e)}function D(e){var n="\ud83c\udca1".charCodeAt(0),t="\ud83c\udca1".charCodeAt(1);return String.fromCharCode(n)+String.fromCharCode(t+e.rank_index+16*e.suit_index+(e.rank===w||e.rank===Y?1:0))}function H(e){return e.rank+e.suit.charAt(0).toUpperCase()}function J(e){var n,t="",r=Object(R.a)(e);try{for(r.s();!(n=r.n()).done;){t+=D(n.value)}}catch(a){r.e(a)}finally{r.f()}return t}function M(e,n){return e===L||n===L?e===L&&n===L:e.index===n.index}var U="everyone";function F(e,n,t){return G.apply(this,arguments)}function G(){return(G=Object(v.a)(m.a.mark((function e(n,t,r){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={name:n,source:t,owner:r,compiled:B(t),hash:null},e.next=3,K(a.compiled);case 3:return a.hash=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function W(e){return{name:e.name,owner:e.owner,hash:e.hash}}function B(e){return console.log("compiling source:"),console.log(e),E(),[1,1,1,1,1,1*e.length]}function K(e){return V.apply(this,arguments)}function V(){return(V=Object(v.a)(m.a.mark((function e(n){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(JSON.stringify(n));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(e,n){return e.hash===n.hash}function Q(e,n,t,r){return r.map((function(e){return{rule:W(e),proof:"this is supposed to be a snark proof",penalty:0}}))}var $,q="INCORRECT_PENALTIES";function X(e,n,t,r){var a=Object(y.a)(t);return console.log("VIOLATED RULES:"),console.log(a),a}var Z={SETUP:"SETUP",PLAY:"PLAY",GAMEOVER:"GAMEOVER",ABORT:"ABORT"},ee=Object.values(Z),ne={PRE_READY:"PRE_READY",SENT_READY:"SENT_READY",SENT_START:"SENT_START"},te=(Object.values(ne),{WAIT_FOR_PLAY:"WAIT_FOR_PLAY",WAIT_FOR_PLAYACK:"WAIT_FOR_PLAYACK"}),re=(Object.values(te),{READY:"READY",START:"START",PLAY:"PLAY",PLAYACK:"PLAYACK",ABORT:"ABORT"}),ae=Object.values(re),ce=($={},Object(x.a)($,re.READY,(function(e,n){if(e.phase!==Z.SETUP&&e.phase!==Z.GAMEOVER)return je(e);var t=e.data[Z.SETUP];if(t.state!==ne.PRE_READY&&t.state!==ne.SENT_READY)return je(e);var r=n.from,a=n.hash;if(t.players.includes(r))return je(e);t.players.push(r),t.readyHashes[r]=a,xe(e),de(e)})),Object(x.a)($,re.START,(function(e,n){return he.apply(this,arguments)})),Object(x.a)($,re.PLAY,(function(e,n){if(e.phase!==Z.PLAY)return je(e,"wrong phase");var t=e.data[e.phase];if(t.state!==te.WAIT_FOR_PLAY)return je(e,"wrong state");var r=n.from,a=n.card,c=n.rules,s=n.provedRules;if(r!==t.players[t.nextTurn])return je(e,"user tried to make move but it's not their turn");if(a!==L&&!t.playerHands[r].some((function(e){return M(e,a)})))return je(e,"user tried to play card not in their hand");if(!be(e,a))return je(e,"user tried to play illegal card");var o=e.allRules.filter((function(e){return e.owner===U||e.owner===r})).map((function(e){return e.hash})),u=s.map((function(e){return e.rule.hash}));if(JSON.stringify(o.sort())!==JSON.stringify(u.sort()))return je(e,"did not prove outcomes for all rules user knows of");var i=X(0,t.playedCards,c);if(i===q)return je(e,"proofs were incorrect somehow :(");pe(e,i),ge(e,r,a,c),function(e,n,t,r){T(e.phase===Z.PLAY,e);var a=e.data[e.phase];T(a.state===te.WAIT_FOR_PLAYACK,e);var c=Q(0,a.playedCards.slice(0,a.playedCards.length-1),0,e.myRules),s=X(0,a.playedCards.slice(0,a.playedCards.length-1),r);T(s!==q,"my own proofs were incorrect lolol im stupid"),pe(e,s),fe(e,{method:re.PLAYACK,card:t,user:n,provedRules:c}),T(!a.acksReceived.includes(e.userId),e),a.acksReceived.push(e.userId),ye(e),de(e)}(e,r,a,c),de(e)})),Object(x.a)($,re.PLAYACK,(function(e,n){if(e.phase!==Z.PLAY)return je(e,"wrong phase");var t=e.data[e.phase];if(t.state!==te.WAIT_FOR_PLAYACK)return je(e,"wrong state");var r=n.user,a=n.from,c=n.card,s=n.provedRules;if(r!==t.lastPlayedUser)return je(e,"tried to ack the wrong user");if(!M(c,t.lastPlayedCard))return je(e,"tried to ack the wrong card");if(t.acksReceived.includes(a))return je(e,"already received ack from this user");var o=e.allRules.filter((function(e){return e.owner===U||e.owner===a})).map((function(e){return e.hash})),u=s.map((function(e){return e.rule.hash}));if(JSON.stringify(o.sort())!==JSON.stringify(u.sort()))return je(e,"did not prove outcomes for all rules user knows of");var i=X(0,t.playedCards.slice(0,t.playedCards.length-1),t.lastSelectedRules);if(i===q)return je(e,"proofs were incorrect somehow :(");pe(e,i),t.acksReceived.push(a),ye(e),de(e)})),Object(x.a)($,re.ABORT,(function(e,n){console.log("ABORTING :(((( SAD"),E(),de(e)})),$);function se(e){var n,t={conn:e,listeners:{},listenerIndex:"0",userId:Math.random().toString(36).substr(2,9),phase:null,data:{},myRules:[],allRules:[]},r=Object(R.a)(ee);try{for(r.s();!(n=r.n()).done;){var a=n.value;t.data[a]={}}}catch(c){r.e(c)}finally{r.f()}return ue(t,Z.SETUP),function(e){F("spades","card.suit == spades",U).then((function(n){e.myRules.push(n);var t=W(n);e.allRules.push(t),de(e)})).then((function(){return F("lastcard","isLastCard()",U)})).then((function(n){e.myRules.push(n);var t=W(n);e.allRules.push(t),de(e)}))}(t),t}function oe(e,n,t){T(ee.includes(n),e);var r={};n===Z.SETUP?r={state:ne.PRE_READY,players:[e.userId],readyHashes:{},startNumbers:{},myRandom:null}:n===Z.PLAY&&(r.players=C(Object(y.a)(e.data[Z.SETUP].players).sort(),t.rng),r.nextTurn=0,r.playedCards=[],r.playerHands=function(e,n,t){var r,a=I(n,t),c={},s=0,o=Object(R.a)(e);try{for(o.s();!(r=o.n()).done;)c[r.value]=[]}catch(l){o.e(l)}finally{o.f()}for(;s<a.length;){var u,i=Object(R.a)(e);try{for(i.s();!(u=i.n()).done;)c[u.value].push(a[s]),s++}catch(l){i.e(l)}finally{i.f()}}return c}(C(r.players,t.rng),t.rng,12),r.state=te.WAIT_FOR_PLAY,r.acksReceived=[],r.lastPlayedCard=null,r.lastPlayedUser=null,r.lastSelectedRules=null,r.penaltyRules=[]),e.data[n]=r}function ue(e,n,t){T(ee.includes(n),e),oe(e,n,t),e.phase=n}function ie(e,n){var t=e.listenerIndex;return e.listeners[t]=n,e.listenerIndex="".concat(parseInt(t)+1),t}function le(e,n){e&&(console.log("removing key ".concat(n," from game ").concat(e)),console.log(e),delete e.listeners[n])}function de(e){for(var n=0,t=Object.values(e.listeners);n<t.length;n++){(0,t[n])()}}function fe(e,n){var t,r;n.from=e.userId,t=e.conn,r=n,j(t,Object(i.a)({type:"data"},r))}function he(){return(he=Object(v.a)(m.a.mark((function e(n,t){var r,a,c,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.phase===Z.SETUP){e.next=2;break}return e.abrupt("return",je(n,"wrong phase"));case 2:if((r=n.data[Z.SETUP]).state===ne.SENT_READY||r.state===ne.SENT_START){e.next=5;break}return e.abrupt("return",je(n));case 5:if(a=t.from,c=t.randomNumber,!Object.keys(r.startNumbers).includes(a)){e.next=9;break}return e.abrupt("return",je(n));case 9:if(r.players.includes(a)){e.next=11;break}return e.abrupt("return",je(n,"unknown user ".concat(a)));case 11:return e.next=13,P("".concat(c));case 13:if(s=e.sent,r.readyHashes[a]===s){e.next=16;break}return e.abrupt("return",je(n,"incorrect hash ".concat(s," received for random number ").concat(c," from user ").concat(a)));case 16:r.startNumbers[a]=c,Re(n),de(n);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pe(e,n){var t,r=e.data[e.phase],a=Object(R.a)(n);try{for(a.s();!(t=a.n()).done;){var c=t.value;r.penaltyRules.includes(c)||r.penaltyRules.push(c)}}catch(s){a.e(s)}finally{a.f()}}function je(e,n){console.error("ABORT GAME :(("),console.error(n),fe(e,{method:re.ABORT,reason:n}),e.phase=Z.ABORT,de(e)}function ge(e,n,t,r){var a=e.data[e.phase];a.nextTurn=(a.nextTurn+1)%a.players.length,a.state=te.WAIT_FOR_PLAYACK,a.lastPlayedCard=t,a.lastPlayedUser=n,a.lastSelectedRules=r,t!==L&&(a.playedCards.push(t),a.playerHands[n]=a.playerHands[n].filter((function(e){return e.index!==t.index}))),de(e)}function be(e,n){var t=e.data[e.phase];if(n===L)return!0;if(0===t.playedCards.length)return!0;var r=t.playedCards[t.playedCards.length-1];return r.suit===n.suit||r.rank===n.rank}function Oe(e,n,t){T(e.phase===Z.PLAY&&Ee(e),e);var r=e.data[e.phase];T(r.state===te.WAIT_FOR_PLAY,e),T(n===L||r.playerHands[e.userId].some((function(e){return M(e,n)})),e),T(t.every((function(n){return e.allRules.filter((function(e){return z(e,n)})).length>0})),e),console.log("play card!"),console.log(n),console.log(t),T(be(e,n),e);var a=Q(0,r.playedCards.slice(0,r.playedCards.length-1),0,e.myRules),c=X(0,r.playedCards.slice(0,r.playedCards.length-1),t);T(c!==q,"your own penalty calculations were wrong lololol"),pe(e,c),fe(e,{method:re.PLAY,card:n,rules:t,provedRules:a}),ge(e,e.userId,n,t),de(e)}function me(e){return ve.apply(this,arguments)}function ve(){return(ve=Object(v.a)(m.a.mark((function e(n){var t,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T(n.phase===Z.SETUP,n),T((t=n.data[Z.SETUP]).state===ne.PRE_READY,n),t.myRandom=Math.floor(Math.random()*Math.pow(2,64)),e.next=6,P("".concat(t.myRandom));case 6:r=e.sent,console.log(r),t.readyHashes[n.userId]=r,fe(n,{method:re.READY,hash:r}),t.state=ne.SENT_READY,xe(n),de(n);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ye(e){var n=e.data[e.phase];n.acksReceived.length===n.players.length-1&&(!function(e,n,t){console.log("enforce penalties:"),console.log(t);for(var r=e.data[e.phase],a=0;a<t.length&&r.playedCards.length>0;a++){var c=r.playedCards[0];r.playerHands[n].push(c),r.playedCards.splice(0,1)}console.log("right before updating the game:"),console.log(JSON.parse(JSON.stringify(e))),de(e)}(e,n.lastPlayedUser,n.penaltyRules),n.state=te.WAIT_FOR_PLAY,n.acksReceived=[],n.lastPlayedCard=null,n.lastPlayedUser=null,n.lastSelectedRules=null,n.penaltyRules=[],function(e){T(e.phase===Z.PLAY,e);var n=e.data[e.phase];T(n.state===te.WAIT_FOR_PLAY,e);var t,r=Object(R.a)(n.players);try{for(r.s();!(t=r.n()).done;){var a=t.value;0===n.playerHands[a].length&&(T(1===Object.values(n.playerHands).filter((function(e){return 0===e.length})).length),e.phase=Z.GAMEOVER,e.data[Z.GAMEOVER].winner=a)}}catch(c){r.e(c)}finally{r.f()}}(e),de(e))}function Re(e){var n=e.data[e.phase];n.players.length===Object.keys(n.startNumbers).length&&function(e){T(e.phase===Z.SETUP);var n=e.data[e.phase];T(n.state===ne.SENT_START,e);var t=0;Object.values(n.startNumbers).forEach((function(e){t^=e})),console.log("final randomness: ".concat(t));var r=S()("".concat(t));ue(e,Z.PLAY,{rng:r}),oe(e,Z.SETUP),console.log("STARTING GAME!!!! exciting :)))"),console.log(e),de(e)}(e)}function xe(e){var n=e.data[Z.SETUP];e.conn,1===Object.keys(n.readyHashes).length-1&&(T(n.players.length===Object.keys(n.readyHashes).length,e),function(e){T(e.phase===Z.SETUP,e);var n=e.data[e.phase];T(n.state===ne.SENT_READY,e),fe(e,{method:re.START,randomNumber:n.myRandom}),n.startNumbers[e.userId]=n.myRandom,n.state=ne.SENT_START,Re(e),de(e)}(e))}function Ae(e){return e.userId}function Se(e){var n=e.data[Z.PLAY].players.filter((function(n){return n!==Ae(e)}))[0];return console.log("opp user id: ".concat(n)),n}function Te(e){var n=e.data[Z.PLAY];return Object(y.a)(n.playerHands[Ae(e)])}function Ce(e){var n=e.data[Z.PLAY].playerHands[Se(e)];return console.log("player hand!"),console.log(JSON.stringify(n)),Object(y.a)(n)}function Ee(e){var n=e.data[Z.PLAY];return Ae(e)===n.players[n.nextTurn]}function Pe(e){var n=e.data[Z.PLAY];return Ee(e)&&n.state===te.WAIT_FOR_PLAY}function ke(e){var n=e.data[Z.PLAY];return Object(y.a)(n.playedCards)}function we(e){return Object(y.a)(e.allRules)}T(JSON.stringify(ae)===JSON.stringify(Object.keys(ce)),{methods:ae,handlers:ce});t(36);function Ye(e){var n=Object(a.useState)(""),t=Object(u.a)(n,2),c=t[0],s=t[1],o=Object(a.useState)(""),i=Object(u.a)(o,2),l=i[0],d=i[1];function f(){j(e.connRef.current,{type:"message",message:c}),g(c),s("")}function g(e){d((function(n){return""===n?e:e+"\n"+n}))}return Object(a.useEffect)((function(){var n=h(e.connRef.current,(function(e){if("message"===e.type)return g(e.message);g(JSON.stringify(e))}));return function(){console.log("cleaning up chat!!! index ".concat(n)),p(e.connRef.current,n)}}),[e.connRef]),Object(r.jsxs)("div",{children:[Object(r.jsx)("input",{type:"text",value:c,onChange:function(e){return s(e.target.value)},onKeyUp:function(e){return"Enter"===e.key?f():0}}),Object(r.jsx)("button",{onClick:f,children:"Send message"}),Object(r.jsx)("p",{style:{whiteSpace:"pre-line"},children:l})]})}function _e(){return Object(r.jsx)("div",{children:"Waiting for everyone else to press start..."})}function Ne(e){var n=Object(a.useState)(ke(e.gameRef.current)),t=Object(u.a)(n,2),c=t[0],s=t[1],o=Object(a.useState)(Te(e.gameRef.current)),i=Object(u.a)(o,2),l=i[0],d=i[1],f=Object(a.useState)(Ce(e.gameRef.current)),h=Object(u.a)(f,2),p=h[0],j=h[1],g=Object(a.useState)(Ae(e.gameRef.current)),b=Object(u.a)(g,2),O=b[0],m=b[1],v=Object(a.useState)(Se(e.gameRef.current)),R=Object(u.a)(v,2),x=R[0],A=R[1],S=Object(a.useState)(null),T=Object(u.a)(S,2),C=T[0],E=T[1],P=Object(a.useState)(Pe(e.gameRef.current)),k=Object(u.a)(P,2),w=k[0],Y=k[1],I=Object(a.useState)([]),D=Object(u.a)(I,2),H=D[0],J=D[1],M=Object(a.useCallback)((function(e){E(e.currentTarget.value)}),[]),U=Object(a.useCallback)((function(e){var n=JSON.parse(e.currentTarget.value);console.log("toggling rule ".concat(n.name)),H.filter((function(e){return z(e,n)})).length>0?J(H.filter((function(e){return!z(e,n)}))):J([n].concat(Object(y.a)(H)))}),[H]),F=Object(a.useCallback)((function(){console.log("updating game state in Play :))))))"),console.log(JSON.parse(JSON.stringify(e.gameRef.current))),s(ke(e.gameRef.current)),d(Te(e.gameRef.current)),j(Ce(e.gameRef.current)),m(Ae(e.gameRef.current)),A(Se(e.gameRef.current)),Y(Pe(e.gameRef.current))}),[e.gameRef]);return Object(a.useEffect)((function(){var n=ie(e.gameRef.current,F);return function(){le(e.gameRef.current,n)}}),[e.gameRef,F]),Object(r.jsxs)("div",{children:[Object(r.jsx)(He,{cards:p,user:x}),Object(r.jsx)(De,{cards:c}),Object(r.jsx)(Je,{cards:l,user:O,changeCard:M,selectedCard:C}),Object(r.jsx)(Le,{rules:e.rules,selectedRules:H,toggleRule:U}),Object(r.jsx)(Ie,{disabled:!w||e.disabled,play:function(){Oe(e.gameRef.current,function(e){var n="\ud83c\udca1".charCodeAt(1),t=e.charCodeAt(1)-n,r=Math.floor(t/16),a=t%16;return a>=12&&a--,{suit:N[r],rank:_[a],suit_index:r,rank_index:a,index:13*r+a}}(C),H),J([])},pass:function(){Oe(e.gameRef.current,L,H),J([])}})]})}function Le(e){return Object(r.jsxs)("div",{style:{marginTop:"5px",marginBottom:"7px"},children:["rules:",Object(r.jsx)("div",{className:"SelectRule",children:e.rules.map((function(n,t){return Object(r.jsxs)(c.a.Fragment,{children:[Object(r.jsx)("input",{type:"checkbox",name:"rules",value:JSON.stringify(n),checked:e.selectedRules.filter((function(e){return z(e,n)})).length>0,onChange:e.toggleRule,id:n.hash},"rulesradio".concat(t)),Object(r.jsx)("label",{htmlFor:n.hash,children:n.name},"ruleslabel".concat(t))]},"rulesfragment".concat(t))}))})]})}function Ie(e){return Object(r.jsxs)("div",{children:[Object(r.jsx)("button",{onClick:e.play,disabled:e.disabled,children:"Play!"}),Object(r.jsx)("button",{onClick:e.pass,disabled:e.disabled,children:"Pass"})]})}function De(e){return Object(r.jsxs)("div",{children:["played cards: ",Object(r.jsx)(Me,{cards:e.cards})]})}function He(e){return Object(r.jsxs)("div",{children:[e.user,"'s cards:",Object(r.jsx)(Me,{cards:e.cards})]})}function Je(e){return Object(r.jsxs)("div",{children:["my cards:",Object(r.jsx)(Ue,{cards:e.cards,changeCard:e.changeCard,selectedCard:e.selectedCard})]})}function Me(e){return 0===e.cards.length?Object(r.jsx)("div",{children:"(none)"}):Object(r.jsx)("div",{style:{fontSize:"3em"},children:J(e.cards)})}function Ue(e){return 0===e.cards.length?Object(r.jsx)("div",{children:"(none)"}):Object(r.jsx)("div",{style:{fontSize:"3em"},className:"SelectableDeck",children:e.cards.map((function(n,t){return Object(r.jsxs)(c.a.Fragment,{children:[Object(r.jsx)("input",{type:"radio",name:"mycards",value:D(n),checked:e.selectedCard===D(n),onChange:e.changeCard,id:H(n)},"mycardsradio".concat(t)),Object(r.jsx)("label",{htmlFor:H(n),children:D(n)},"mycardslabel".concat(t))]},"mycardsfragment".concat(t))}))})}function Fe(e){return Object(r.jsxs)("div",{children:[Object(r.jsxs)("div",{style:{fontSize:"2em"},children:["Game is over!!!! ",e.winner," won!"]}),Object(r.jsx)("button",{onClick:function(){return(n=e.gameRef.current).phase=Z.SETUP,void me(n);var n},children:"Play again!"})]})}function Ge(e){return Object(r.jsxs)("div",{children:["Rules:",Object(r.jsx)("ul",{children:e.rules.map((function(e){return Object(r.jsx)("li",{children:JSON.stringify(e)},e.hash)}))})]})}function We(e){var n,t=Object(a.useState)(e.gameRef.current.phase),s=Object(u.a)(t,2),o=s[0],i=s[1],l=Object(a.useState)(Ae(e.gameRef.current)),d=Object(u.a)(l,2),f=d[0],h=d[1],p=Object(a.useState)(we(e.gameRef.current)),j=Object(u.a)(p,2),g=j[0],b=j[1],O=Object(a.useCallback)((function(){i(e.gameRef.current.phase),h(Ae(e.gameRef.current)),b(we(e.gameRef.current))}),[e.gameRef]);return Object(a.useEffect)((function(){var n=ie(e.gameRef.current,O);return function(){le(e.gameRef.current,n)}}),[e.gameRef,O]),Object(r.jsxs)("div",{children:["welcome to the game, ",f,"!",Object(r.jsx)("hr",{}),o===Z.GAMEOVER&&Object(r.jsxs)(c.a.Fragment,{children:[Object(r.jsx)(Fe,{gameRef:e.gameRef,winner:(n=e.gameRef.current,n.data[Z.GAMEOVER].winner)}),Object(r.jsx)("hr",{})]}),o===Z.SETUP&&Object(r.jsxs)(c.a.Fragment,{children:[Object(r.jsx)(_e,{}),Object(r.jsx)("hr",{})]}),Object(r.jsx)(Ge,{rules:g}),Object(r.jsx)("hr",{}),(o===Z.PLAY||o===Z.GAMEOVER)&&Object(r.jsxs)(c.a.Fragment,{children:[Object(r.jsx)(Ne,{gameRef:e.gameRef,disabled:o===Z.GAMEOVER,rules:g}),Object(r.jsx)("hr",{})]}),Object(r.jsx)(Ye,{connRef:e.connRef})]})}function Be(e){return Object(r.jsx)("div",{children:Object(r.jsx)("button",{onClick:function(){return n=e.connRef.current,t=e.setMyOffer,console.log("create offer"),console.log(n.pc.signalingState),n.dc=n.pc.createDataChannel("chat"),n.dc.onopen=function(){return d(n)},n.dc.onmessage=function(e){return f(n,e)},n.pc.createOffer().then((function(e){return n.pc.setLocalDescription(e)})).catch(console.log),void(n.pc.onicecandidate=function(e){e.candidate||t(g(JSON.stringify(n.pc.localDescription)))});var n,t},children:"Create game"})})}function Ke(e){var n=Object(a.useState)(""),t=Object(u.a)(n,2),c=t[0],s=t[1];return Object(r.jsxs)("div",{children:["send this message to your friends: ",Object(r.jsx)("code",{children:e.offer}),Object(r.jsx)("br",{}),"input their answer:",Object(r.jsx)("input",{type:"text",value:c,onChange:function(e){return s(e.target.value)}}),Object(r.jsx)("button",{onClick:function(){return function(e,n){console.log("join"),console.log(e.pc.signalingState);var t=new RTCSessionDescription(JSON.parse(b(n)));e.pc.setRemoteDescription(t).catch(console.log)}(e.connRef.current,c)},children:"Add player"})]})}function Ve(e){var n=Object(a.useState)(""),t=Object(u.a)(n,2),c=t[0],s=t[1];return Object(r.jsxs)("div",{children:[Object(r.jsx)("input",{type:"text",value:c,onChange:function(e){return s(e.target.value)}}),Object(r.jsx)("button",{onClick:function(){return function(e,n,t){console.log("join"),console.log(e.pc.signalingState);var r=new RTCSessionDescription(JSON.parse(b(n)));e.pc.setRemoteDescription(r).then((function(){return e.pc.createAnswer()})).then((function(n){return e.pc.setLocalDescription(n)})).catch(console.log),e.pc.onicecandidate=function(n){n.candidate||t(g(JSON.stringify(e.pc.localDescription)))}}(e.connRef.current,c,e.setMyAnswer)},children:"Join"})]})}function ze(e){return Object(r.jsxs)("div",{children:["send this message to your friends: ",Object(r.jsx)("code",{children:e.answer}),Object(r.jsx)("br",{})]})}function Qe(e){return console.log(e.connRef),Object(r.jsxs)("div",{children:[Object(r.jsx)(Be,{connRef:e.connRef,setMyOffer:e.setMyOffer}),Object(r.jsx)("br",{}),Object(r.jsx)(Ve,{connRef:e.connRef,setMyAnswer:e.setMyAnswer}),Object(r.jsx)("br",{})]})}function $e(e){return Object(r.jsxs)("div",{children:[e.offer?Object(r.jsx)(Ke,{connRef:e.connRef,offer:e.offer}):Object(r.jsx)(ze,{connRef:e.connRef,answer:e.answer}),Object(r.jsx)("hr",{}),"Participants list: idk",Object(r.jsx)("br",{}),Object(r.jsx)("hr",{}),Object(r.jsx)("button",{onClick:e.startGame,children:"Start game!"}),Object(r.jsx)("hr",{}),Object(r.jsx)(Ye,{connRef:e.connRef})]})}function qe(e){var n=Object(a.useState)(null),t=Object(u.a)(n,2),s=t[0],o=t[1],i=Object(a.useState)(null),l=Object(u.a)(i,2),d=l[0],f=l[1];return s||d?Object(r.jsx)($e,{connRef:e.connRef,offer:s,answer:d,startGame:e.startGame}):Object(r.jsx)(c.a.Fragment,{children:Object(r.jsx)(Qe,{connRef:e.connRef,setMyOffer:o,setMyAnswer:f})})}var Xe=function(){var e=Object(a.useState)(!0),n=Object(u.a)(e,2),t=n[0],c=n[1],s=Object(a.useRef)(),o=Object(a.useRef)(),i=Object(a.useCallback)((function(){c(!1),me(o.current)}),[o]);return Object(a.useEffect)((function(){s.current=function(){var e={pc:new RTCPeerConnection(l),dc:null,messageHandlers:{},messageHandlersIndx:"0"};return e.pc.ondatachannel=function(n){e.dc=n.channel,e.dc.onopen=function(){return d(e)},e.dc.onmessage=function(n){return f(e,n)}},e.pc.oniceconnectionstatechange=function(n){return console.log(e.pc.iceConnectionState)},e}(),o.current=se(s.current)}),[]),Object(a.useEffect)((function(){var e=h(s.current,(function(e){return function(e,n){console.log("game receiving message!"),console.log(n),"data"===n.type?(T(ae.includes(n.method)),console.log(ce),ce[n.method](e,n)):console.log("ignoring non-data message")}(o.current,e)}));return function(){p(s.current,e)}}),[s,o]),Object(r.jsxs)("div",{className:"App",children:[t&&Object(r.jsx)(qe,{connRef:s,startGame:i}),!t&&Object(r.jsx)(We,{connRef:s,gameRef:o})]})},Ze=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,38)).then((function(n){var t=n.getCLS,r=n.getFID,a=n.getFCP,c=n.getLCP,s=n.getTTFB;t(e),r(e),a(e),c(e),s(e)}))},en=t(18),nn=t(19),tn=t(7),rn=t.n(tn),an=rn()("21888242871839275222246405745257275088548364400416034343698204186575808495617"),cn=["0","7120861356467848435263064379192047478074060781135320967663101236819528304084","5024705281721889198577876690145313457398658950011302225525409148828000436681","17980351014018068290387269214713820287804403312720763401943303895585469787384","19886576439381707240399940949310933992335779767309383709787331470398675714258","1213715278223786725806155661738676903520350859678319590331207960381534602599","18162138253399958831050545255414688239130588254891200470934232514682584734511","7667462281466170157858259197976388676420847047604921256361474169980037581876","7207551498477838452286210989212982851118089401128156132319807392460388436957","9864183311657946807255900203841777810810224615118629957816193727554621093838","4798196928559910300796064665904583125427459076060519468052008159779219347957","17387238494588145257484818061490088963673275521250153686214197573695921400950","10005334761930299057035055370088813230849810566234116771751925093634136574742","11897542014760736209670863723231849628230383119798486487899539017466261308762","16771780563523793011283273687253985566177232886900511371656074413362142152543","749264854018824809464168489785113337925400687349357088413132714480582918506","3683645737503705042628598550438395339383572464204988015434959428676652575331","7556750851783822914673316211129907782679509728346361368978891584375551186255","20391289379084797414557439284689954098721219201171527383291525676334308303023","18146517657445423462330854383025300323335289319277199154920964274562014376193","8080173465267536232534446836148661251987053305394647905212781979099916615292","10796443006899450245502071131975731672911747129805343722228413358507805531141","5404287610364961067658660283245291234008692303120470305032076412056764726509","4623894483395123520243967718315330178025957095502546813929290333264120223168","16845753148201777192406958674202574751725237939980634861948953189320362207797","4622170486584704769521001011395820886029808520586507873417553166762370293671","16688277490485052681847773549197928630624828392248424077804829676011512392564","11878652861183667748838188993669912629573713271883125458838494308957689090959","2436445725746972287496138382764643208791713986676129260589667864467010129482","1888098689545151571063267806606510032698677328923740058080630641742325067877","148924106504065664829055598316821983869409581623245780505601526786791681102","18875020877782404439294079398043479420415331640996249745272087358069018086569","15189693413320228845990326214136820307649565437237093707846682797649429515840","19669450123472657781282985229369348220906547335081730205028099210442632534079","5521922218264623411380547905210139511350706092570900075727555783240701821773","4144769320246558352780591737261172907511489963810975650573703217887429086546","10097732913112662248360143041019433907849917041759137293018029019134392559350","1720059427972723034107765345743336447947522473310069975142483982753181038321","6302388219880227251325608388535181451187131054211388356563634768253301290116","6745410632962119604799318394592010194450845483518862700079921360015766217097","10858157235265583624235850660462324469799552996870780238992046963007491306222","20241898894740093733047052816576694435372877719072347814065227797906130857593","10165780782761211520836029617746977303303335603838343292431760011576528327409","2832093654883670345969792724123161241696170611611744759675180839473215203706","153011722355526826233082383360057587249818749719433916258246100068258954737","20196970640587451358539129330170636295243141659030208529338914906436009086943","3180973917010545328313139835982464870638521890385603025657430208141494469656","17198004293191777441573635123110935015228014028618868252989374962722329283022","7642160509228669138628515458941659189680509753651629476399516332224325757132","19346204940546791021518535594447257347218878114049998691060016493806845179755","11501810868606870391127866188394535330696206817602260610801897042898616817272","3113973447392053821824427670386252797811804954746053461397972968381571297505","6545064306297957002139416752334741502722251869537551068239642131448768236585","5203908808704813498389265425172875593837960384349653691918590736979872578408","2246692432011290582160062129070762007374502637007107318105405626910313810224","11760570435432189127645691249600821064883781677693087773459065574359292849137","5543749482491340532547407723464609328207990784853381797689466144924198391839","8837549193990558762776520822018694066937602576881497343584903902880277769302","12855514863299373699594410385788943772765811961581749194183533625311486462501","5363660674689121676875069134269386492382220935599781121306637800261912519729","13162342403579303950549728848130828093497701266240457479693991108217307949435","916941639326869583414469202910306428966657806899788970948781207501251816730","15618589556584434434009868216186115416835494805174158488636000580759692174228","8959562060028569701043973060670353733575345393653685776974948916988033453971","16390754464333401712265575949874369157699293840516802426621216808905079127650","168282396747788514908709091757591226095443902501365500003618183905496160435","8327443473179334761744301768309008451162322941906921742120510244986704677004","17213012626801210615058753489149961717422101711567228037597150941152495100640","10394369641533736715250242399198097296122982486516256408681925424076248952280","17784386835392322654196171115293700800825771210400152504776806618892170162248","16533189939837087893364000390641148516479148564190420358849587959161226782982","18725396114211370207078434315900726338547621160475533496863298091023511945076","7132325028834551397904855671244375895110341505383911719294705267624034122405","148317947440800089795933930720822493695520852448386394775371401743494965187","19001050671757720352890779127693793630251266879994702723636759889378387053056","18824274411769830274877839365728651108434404855803844568234862945613766611460","12771414330193951156383998390424063470766226667986423961689712557338777174205","11332046574800279729678603488745295198038913503395629790213378101166488244657","9607550223176946388146938069307456967842408600269548190739947540821716354749","8756385288462344550200229174435953103162307705310807828651304665320046782583","176061952957067086877570020242717222844908281373122372938833890096257042779","12200212977482648306758992405065921724409841940671166017620928947866825250857","10868453624107875516866146499877130701929063632959660262366632833504750028858","2016095394399807253596787752134573207202567875457560571095586743878953450738","21815578223768330433802113452339488275704145896544481092014911825656390567514","4923772847693564777744725640710197015181591950368494148029046443433103381621","1813584943682214789802230765734821149202472893379265320098816901270224589984","10810123816265612772922113403831964815724109728287572256602010709288980656498","1153669123397255702524721206511185557982017410156956216465120456256288427021","5007518659266430200134478928344522649876467369278722765097865662497773767152","2511432546938591792036639990606464315121646668029252285288323664350666551637","32883284540320451295484135704808083452381176816565850047310272290579727564","10484856914279112612610993418405543310546746652738541161791501150994088679557","2026733759645519472558796412979210009170379159866522399881566309631434814953","14731806221235869882801331463708736361296174006732553130708107037190460654379","14740327483193277147065845135561988641238516852487657117813536909482068950652","18787428285295558781869865751953016580493190547148386433580291216673009884554","3804047064713122820157099453648459188816376755739202017447862327783289895072","16709604795697901641948603019242067672006293290826991671766611326262532802914","11061717085931490100602849654034280576915102867237101935487893025907907250695","2821730726367472966906149684046356272806484545281639696873240305052362149654","17467794879902895769410571945152708684493991588672014763135370927880883292655","1571520786233540988201616650622796363168031165456869481368085474420849243232","10041051776251223165849354194892664881051125330236567356945669006147134614302","3981753758468103976812813304477670033098707002886030847251581853700311567551","4365864398105436789177703571412645548020537580493599380018290523813331678900","2391801327305361293476178683853802679507598622000359948432171562543560193350","214219368547551689972421167733597094823289857206402800635962137077096090722","18192064100315141084242006659317257023098826945893371479835220462302399655674","15487549757142039139328911515400805508248576685795694919457041092150651939253","10142447197759703415402259672441315777933858467700579946665223821199077641122","11246573086260753259993971254725613211193686683988426513880826148090811891866","6574066859860991369704567902211886840188702386542112593710271426704432301235","11311085442652291634822798307831431035776248927202286895207125867542470350078","20977948360215259915441258687649465618185769343138135384346964466965010873779","792781492853909872425531014397300057232399608769451037135936617996830018501","5027602491523497423798779154966735896562099398367163998686335127580757861872","14595204575654316237672764823862241845410365278802914304953002937313300553572","13973538843621261113924259058427434053808430378163734641175100160836376897004","16395063164993626722686882727042150241125309409717445381854913964674649318585","8465768840047024550750516678171433288207841931251654898809033371655109266663","21345603324471810861925019445720576814602636473739003852898308205213912255830","21171984405852590343970239018692870799717057961108910523876770029017785940991","10761027113757988230637066281488532903174559953630210849190212601991063767647","6678298831065390834922566306988418588227382406175769592902974103663687992230","4993662582188632374202316265508850988596880036291765531885657575099537176757","18364168158495573675698600238443218434246806358811328083953887470513967121206","3506345610354615013737144848471391553141006285964325596214723571988011984829","248732676202643792226973868626360612151424823368345645514532870586234380100","10090204501612803176317709245679152331057882187411777688746797044706063410969","21297149835078365363970699581821844234354988617890041296044775371855432973500","16729368143229828574342820060716366330476985824952922184463387490091156065099","4467191506765339364971058668792642195242197133011672559453028147641428433293","8677548159358013363291014307402600830078662555833653517843708051504582990832","1022951765127126818581466247360193856197472064872288389992480993218645055345","1888195070251580606973417065636430294417895423429240431595054184472931224452","4221265384902749246920810956363310125115516771964522748896154428740238579824","2825393571154632139467378429077438870179957021959813965940638905853993971879","19171031072692942278056619599721228021635671304612437350119663236604712493093","10780807212297131186617505517708903709488273075252405602261683478333331220733","18230936781133176044598070768084230333433368654744509969087239465125979720995","16901065971871379877929280081392692752968612240624985552337779093292740763381","146494141603558321291767829522948454429758543710648402457451799015963102253","2492729278659146790410698334997955258248120870028541691998279257260289595548","2204224910006646535594933495262085193210692406133533679934843341237521233504","16062117410185840274616925297332331018523844434907012275592638570193234893570","5894928453677122829055071981254202951712129328678534592916926069506935491729","4947482739415078212217504789923078546034438919537985740403824517728200332286","16143265650645676880461646123844627780378251900510645261875867423498913438066","397690828254561723549349897112473766901585444153303054845160673059519614409","11272653598912269895509621181205395118899451234151664604248382803490621227687","15566927854306879444693061574322104423426072650522411176731130806720753591030","14222898219492484180162096141564251903058269177856173968147960855133048449557","16690275395485630428127725067513114066329712673106153451801968992299636791385","3667030990325966886479548860429670833692690972701471494757671819017808678584","21280039024501430842616328642522421302481259067470872421086939673482530783142","15895485136902450169492923978042129726601461603404514670348703312850236146328","7733050956302327984762132317027414325566202380840692458138724610131603812560","438123800976401478772659663183448617575635636575786782566035096946820525816","814913922521637742587885320797606426167962526342166512693085292151314976633","12368712287081330853637674140264759478736012797026621876924395982504369598764","2494806857395134874309386694756263421445039103814920780777601708371037591569","16101132301514338989512946061786320637179843435886825102406248183507106312877","6252650284989960032925831409804233477770646333900692286731621844532438095656","9277135875276787021836189566799935097400042171346561246305113339462708861695","10493603554686607050979497281838644324893776154179810893893660722522945589063","8673089750662709235894359384294076697329948991010184356091130382437645649279","9558393272910366944245875920138649617479779893610128634419086981339060613250","19012287860122586147374214541764572282814469237161122489573881644994964647218","9783723818270121678386992630754842961728702994964214799008457449989291229500","15550788416669474113213749561488122552422887538676036667630838378023479382689","15016165746156232864069722572047169071786333815661109750860165034341572904221","6506225705710197163670556961299945987488979904603689017479840649664564978574","10796631184889302076168355684722130903785890709107732067446714470783437829037","19871836214837460419845806980869387567383718044439891735114283113359312279540","20871081766843466343749609089986071784031203517506781251203251608363835140622","5100105771517691442278432864090229416166996183792075307747582375962855820797","8777887112076272395250620301071581171386440850451972412060638225741125310886","5300440870136391278944213332144327695659161151625757537632832724102670898756","1205448543652932944633962232545707633928124666868453915721030884663332604536","5542499997310181530432302492142574333860449305424174466698068685590909336771","11028094245762332275225364962905938096659249161369092798505554939952525894293","19187314764836593118404597958543112407224947638377479622725713735224279297009","17047263688548829001253658727764731047114098556534482052135734487985276987385","19914849528178967155534624144358541535306360577227460456855821557421213606310","2929658084700714257515872921366736697080475676508114973627124569375444665664","15092262360719700162343163278648422751610766427236295023221516498310468956361","21578580340755653236050830649990190843552802306886938815497471545814130084980","1258781501221760320019859066036073675029057285507345332959539295621677296991","3819598418157732134449049289585680301176983019643974929528867686268702720163","8653175945487997845203439345797943132543211416447757110963967501177317426221","6614652990340435611114076169697104582524566019034036680161902142028967568142","19212515502973904821995111796203064175854996071497099383090983975618035391558","18664315914479294273286016871365663486061896605232511201418576829062292269769","11498264615058604317482574216318586415670903094838791165247179252175768794889","10814026414212439999107945133852431304483604215416531759535467355316227331774","17566185590731088197064706533119299946752127014428399631467913813769853431107","14016139747289624978792446847000951708158212463304817001882956166752906714332","8242601581342441750402731523736202888792436665415852106196418942315563860366","9244680976345080074252591214216060854998619670381671198295645618515047080988","12216779172735125538689875667307129262237123728082657485828359100719208190116","10702811721859145441471328511968332847175733707711670171718794132331147396634","6479667912792222539919362076122453947926362746906450079329453150607427372979","15117544653571553820496948522381772148324367479772362833334593000535648316185","6842203153996907264167856337497139692895299874139131328642472698663046726780","12732823292801537626009139514048596316076834307941224506504666470961250728055","6936272626871035740815028148058841877090860312517423346335878088297448888663","17297554111853491139852678417579991271009602631577069694853813331124433680030","16641596134749940573104316021365063031319260205559553673368334842484345864859","7400481189785154329569470986896455371037813715804007747228648863919991399081","2273205422216987330510475127669563545720586464429614439716564154166712854048","15162538063742142685306302282127534305212832649282186184583465569986719234456","5628039096440332922248578319648483863204530861778160259559031331287721255522","16085392195894691829567913404182676871326863890140775376809129785155092531260","14227467863135365427954093998621993651369686288941275436795622973781503444257","18224457394066545825553407391290108485121649197258948320896164404518684305122","274945154732293792784580363548970818611304339008964723447672490026510689427","11050822248291117548220126630860474473945266276626263036056336623671308219529","2119542016932434047340813757208803962484943912710204325088879681995922344971","0"].map((function(e){return rn()(e)})),sn=function(){function e(n,t){Object(en.a)(this,e),this.l=void 0,this.r=void 0,this.rounds=void 0,this.k=void 0,this.l=rn()(0),this.r=rn()(0),this.rounds=n,this.k=t}return Object(nn.a)(e,[{key:"inject",value:function(e){this.l=this.l.add(e).mod(an)}},{key:"mix",value:function(){for(var e=0;e<this.rounds-1;e++){var n=this.k.add(this.l).add(cn[e]).mod(an).modPow(5,an).add(this.r).mod(an);this.r=this.l,this.l=n}var t=this.k.add(this.l).mod(an);this.r=t.modPow(5,an).add(this.r).mod(an)}}]),e}();function on(e,n,t,r){var a,c=new sn(t,rn()(r)),s=Object(R.a)(e);try{for(s.s();!(a=s.n()).done;){var o=a.value;c.inject(o),c.mix()}}catch(l){s.e(l)}finally{s.f()}for(var u=[c.l],i=0;i<n-1;i++)c.mix(),u.push(c.l);return u}var un=function(e){var n=rn()(e).mod(an);return n.lesser(rn()(0))&&(n=n.add(an)),n},ln=function(e,n){return function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return on(r.map((function(e){return un(e)})),1,e,n)[0]}},dn=ln(220,0),fn=(ln(4,0),ln(4,8),dn);o.a.render(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(Xe,{})}),document.getElementById("root")),console.log(fn(8034690221294951e44,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)),Ze()}},[[37,1,2]]]);
//# sourceMappingURL=main.ea2ff789.chunk.js.map